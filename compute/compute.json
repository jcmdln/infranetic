{
    "builders": [
        {
            "accelerator": "kvm",
            "boot_command": [
                "e<down><down><end> ",
                "inst.ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/ks.cfg",
                "<leftCtrlOn>x<leftCtrlOff>"
            ],
            "boot_wait": "5s",
            "cpus": "2",
            "disk_compression": true,
            "disk_interface": "virtio-scsi",
            "disk_size": "20G",
            "format": "qcow2",
            "headless": true,
            "http_directory": "http",
            "iso_checksum": "sha256:{{user `checksum`}}",
            "iso_url": "http://mirrors.kernel.org/fedora/releases/33/Everything/x86_64/iso/Fedora-Everything-netinst-x86_64-33-1.2.iso",
            "memory": "2048",
            "net_device": "virtio-net",
            "output_directory": "build/",
            "qemuargs": [
                [
                    "-bios",
                    "/usr/share/edk2/ovmf/OVMF_CODE.fd"
                ]
            ],
            "shutdown_command": "echo {{user `userpass`}} | sudo -S poweroff",
            "ssh_agent_auth": false,
            "ssh_password": "{{user `userpass`}}",
            "ssh_timeout": "15m",
            "ssh_username": "{{user `userpass`}}",
            "type": "qemu",
            "vm_name": "{{user `name`}}.qcow2"
        }
    ],
    "post-processors": [
        {
            "keep_input_artifact": true,
            "output": "build/{{user `name`}}.box",
            "type": "vagrant"
        }
    ],
    "provisioners": [
        {
            "ansible_ssh_extra_args": [
                "-o PubkeyAcceptedKeyTypes=+ssh-dss"
            ],
            "extra_arguments": [
                "-e ansible_sudo_pass={{user `userpass`}}"
            ],
            "playbook_file": "../ansible/site.yml",
            "type": "ansible"
        },
        {
            "ansible_ssh_extra_args": [
                "-o PubkeyAcceptedKeyTypes=+ssh-dss"
            ],
            "extra_arguments": [
                "-e ansible_sudo_pass={{user `userpass`}}"
            ],
            "playbook_file": "ansible/site.yml",
            "type": "ansible"
        }
    ],
    "variables": {
        "checksum": "964fb135339759f54300130922b1b46dc153b6ed2f8ea538b316757f8ee707bc",
        "name": "compute-amd64-qemu",
        "userpass": "infranetic"
    }
}
